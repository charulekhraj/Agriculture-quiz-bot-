<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriMind AI - Agricultural Intelligence Platform</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- PyScript for Python Runtime -->
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css" />
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
    
    <!-- Chart.js for Analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #059669;
            --primary-dark: #047857;
            --accent: #f59e0b;
            --bg-dark: #0f172a;
            --card-bg: rgba(30, 41, 59, 0.7);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            overflow-x: hidden;
        }

        h1, h2, h3, .brand-font {
            font-family: 'Space Grotesk', sans-serif;
        }

        /* Animated Background */
        .bg-mesh {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 20% 50%, rgba(5, 150, 105, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
            animation: meshMove 20s ease infinite;
        }

        @keyframes meshMove {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(-20px, 20px); }
        }

        /* Glassmorphism Cards */
        .glass-card {
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        /* Neural Network Animation */
        .neural-node {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(5, 150, 105, 0.6);
            border-radius: 50%;
            animation: pulse 3s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5); }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a;
        }
        ::-webkit-scrollbar-thumb {
            background: #059669;
            border-radius: 4px;
        }

        /* Typing Effect */
        .typing-cursor::after {
            content: '|';
            animation: blink 1s infinite;
            color: #059669;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* Option Hover Effects */
        .option-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid transparent;
        }
        .option-card:hover {
            transform: translateX(8px);
            border-color: rgba(5, 150, 105, 0.5);
            background: rgba(5, 150, 105, 0.1);
        }
        .option-card.selected {
            border-color: #059669;
            background: rgba(5, 150, 105, 0.2);
        }
        .option-card.correct {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.2);
        }
        .option-card.incorrect {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.2);
        }

        /* Loading Spinner */
        .spinner {
            border: 3px solid rgba(5, 150, 105, 0.3);
            border-radius: 50%;
            border-top: 3px solid #059669;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Progress Ring */
        .progress-ring {
            transform: rotate(-90deg);
        }
        .progress-ring-circle {
            transition: stroke-dashoffset 0.5s ease-in-out;
        }

        /* Floating Particles */
        .particle {
            position: absolute;
            pointer-events: none;
            opacity: 0.6;
            animation: float 10s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        /* Confetti */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #059669;
            animation: confetti-fall 3s ease-out forwards;
        }

        @keyframes confetti-fall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(500px) rotate(720deg); opacity: 0; }
        }

        /* Syntax Highlighting for Code Blocks */
        .code-block {
            background: #1e293b;
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Fira Code', monospace;
            font-size: 0.875rem;
            overflow-x: auto;
        }

        /* Tooltip */
        .tooltip {
            position: relative;
        }
        .tooltip:hover::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #0f172a;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            white-space: nowrap;
            border: 1px solid #059669;
            z-index: 50;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div class="bg-mesh"></div>

    <!-- Navigation -->
    <nav class="glass-card sticky top-0 z-50 border-b border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl flex items-center justify-center shadow-lg shadow-emerald-500/20">
                        <i class="fas fa-seedling text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-white brand-font tracking-tight">AgriMind<span class="text-emerald-400">AI</span></h1>
                        <p class="text-xs text-slate-400">Neural Agricultural Intelligence</p>
                    </div>
                </div>
                
                <div class="hidden md:flex items-center space-x-6">
                    <div class="flex items-center space-x-2 text-sm text-slate-300">
                        <i class="fas fa-database text-emerald-400"></i>
                        <span>Vector DB: <span class="text-emerald-400 font-mono">Connected</span></span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-slate-300">
                        <i class="fas fa-brain text-amber-400"></i>
                        <span>LLM: <span class="text-amber-400 font-mono">Active</span></span>
                    </div>
                    <div class="w-px h-6 bg-white/10"></div>
                    <button onclick="app.toggleProfile()" class="flex items-center space-x-2 hover:text-emerald-400 transition-colors">
                        <div class="w-8 h-8 rounded-full bg-gradient-to-r from-emerald-600 to-teal-600 flex items-center justify-center text-sm font-bold">
                            F
                        </div>
                        <span class="text-sm font-medium">Farmer Joe</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-1 max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Dashboard Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 mb-8">
            
            <!-- Left Sidebar: Stats & Topics -->
            <div class="lg:col-span-3 space-y-6">
                <!-- Progress Card -->
                <div class="glass-card rounded-2xl p-6 relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-emerald-500/10 rounded-full blur-3xl -mr-16 -mt-16"></div>
                    
                    <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                        <i class="fas fa-chart-pie text-emerald-400"></i>
                        <span>Learning Progress</span>
                    </h3>
                    
                    <div class="flex items-center justify-center mb-4">
                        <div class="relative w-32 h-32">
                            <svg class="progress-ring w-32 h-32">
                                <circle cx="64" cy="64" r="56" stroke="rgba(255,255,255,0.1)" stroke-width="8" fill="none"/>
                                <circle id="progress-circle" cx="64" cy="64" r="56" stroke="#059669" stroke-width="8" fill="none" 
                                    stroke-dasharray="351.86" stroke-dashoffset="351.86" stroke-linecap="round" class="progress-ring-circle"/>
                            </svg>
                            <div class="absolute inset-0 flex items-center justify-center flex-col">
                                <span id="progress-text" class="text-2xl font-bold text-white">0%</span>
                                <span class="text-xs text-slate-400">Mastery</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-3">
                        <div class="flex justify-between text-sm">
                            <span class="text-slate-400">Questions Answered</span>
                            <span id="stats-answered" class="text-white font-mono">0</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-slate-400">Accuracy Rate</span>
                            <span id="stats-accuracy" class="text-emerald-400 font-mono">0%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-slate-400">Current Streak</span>
                            <span id="stats-streak" class="text-amber-400 font-mono">0</span>
                        </div>
                    </div>
                </div>

                <!-- Topic Filter -->
                <div class="glass-card rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                        <i class="fas fa-filter text-emerald-400"></i>
                        <span>Knowledge Domains</span>
                    </h3>
                    <div class="space-y-2" id="topic-filters">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <!-- Vector Visualization -->
                <div class="glass-card rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                        <i class="fas fa-project-diagram text-emerald-400"></i>
                        <span>Semantic Space</span>
                    </h3>
                    <canvas id="vector-viz" class="w-full h-48 rounded-lg bg-slate-900/50"></canvas>
                    <p class="text-xs text-slate-400 mt-2 text-center">2D projection of farming tip embeddings</p>
                </div>
            </div>

            <!-- Center: Quiz Interface -->
            <div class="lg:col-span-6 space-y-6">
                <!-- Question Card -->
                <div id="quiz-container" class="glass-card rounded-2xl p-8 min-h-[500px] relative overflow-hidden">
                    <!-- Background Pattern -->
                    <div class="absolute inset-0 opacity-5" style="background-image: radial-gradient(circle at 2px 2px, white 1px, transparent 0); background-size: 24px 24px;"></div>
                    
                    <!-- Loading State -->
                    <div id="loading-state" class="hidden absolute inset-0 flex items-center justify-center bg-slate-900/80 backdrop-blur-sm z-20">
                        <div class="flex flex-col items-center space-y-4">
                            <div class="spinner"></div>
                            <p class="text-emerald-400 text-sm animate-pulse">Retrieving from Vector DB...</p>
                            <p class="text-slate-400 text-xs">Embedding query: "optimal irrigation techniques"</p>
                        </div>
                    </div>

                    <!-- Start Screen -->
                    <div id="start-screen" class="flex flex-col items-center justify-center h-full space-y-6 text-center">
                        <div class="w-24 h-24 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl flex items-center justify-center shadow-2xl shadow-emerald-500/20 mb-4 animate-bounce">
                            <i class="fas fa-robot text-4xl text-white"></i>
                        </div>
                        <h2 class="text-3xl font-bold brand-font">Ready to cultivate knowledge?</h2>
                        <p class="text-slate-400 max-w-md">
                            AgriMind AI uses vector similarity search and large language models to provide personalized agricultural assessments with deep contextual feedback.
                        </p>
                        <div class="grid grid-cols-2 gap-4 w-full max-w-md mt-6">
                            <div class="glass-card p-4 rounded-xl text-center">
                                <i class="fas fa-leaf text-emerald-400 text-2xl mb-2"></i>
                                <p class="text-sm font-medium">Crop Science</p>
                                <p class="text-xs text-slate-400">124 tips</p>
                            </div>
                            <div class="glass-card p-4 rounded-xl text-center">
                                <i class="fas fa-tint text-blue-400 text-2xl mb-2"></i>
                                <p class="text-sm font-medium">Water Management</p>
                                <p class="text-xs text-slate-400">89 tips</p>
                            </div>
                            <div class="glass-card p-4 rounded-xl text-center">
                                <i class="fas fa-bug text-red-400 text-2xl mb-2"></i>
                                <p class="text-sm font-medium">Pest Control</p>
                                <p class="text-xs text-slate-400">156 tips</p>
                            </div>
                            <div class="glass-card p-4 rounded-xl text-center">
                                <i class="fas fa-tractor text-amber-400 text-2xl mb-2"></i>
                                <p class="text-sm font-medium">Machinery</p>
                                <p class="text-xs text-slate-400">67 tips</p>
                            </div>
                        </div>
                        <button onclick="app.startQuiz()" class="mt-8 px-8 py-4 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white rounded-xl font-semibold shadow-lg shadow-emerald-500/25 transition-all transform hover:scale-105 flex items-center space-x-2">
                            <span>Start Assessment</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>

                    <!-- Question Interface -->
                    <div id="question-interface" class="hidden h-full flex flex-col">
                        <!-- Question Header -->
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center space-x-3">
                                <span id="question-category" class="px-3 py-1 rounded-full text-xs font-medium bg-emerald-500/20 text-emerald-400 border border-emerald-500/30">
                                    Crop Science
                                </span>
                                <span class="text-slate-400 text-sm">Question <span id="q-current">1</span>/<span id="q-total">5</span></span>
                            </div>
                            <div class="flex items-center space-x-2 text-amber-400">
                                <i class="fas fa-fire"></i>
                                <span id="streak-display" class="font-bold">0</span>
                            </div>
                        </div>

                        <!-- Question Text -->
                        <div class="mb-8">
                            <h3 id="question-text" class="text-2xl font-bold leading-relaxed mb-4 brand-font typing-cursor">
                                Loading question...
                            </h3>
                            <div id="context-box" class="glass-card p-4 rounded-xl border-l-4 border-emerald-500 bg-emerald-500/5 hidden">
                                <p class="text-sm text-slate-300 italic" id="context-text"></p>
                            </div>
                        </div>

                        <!-- Options -->
                        <div id="options-container" class="space-y-3 mb-8 flex-1">
                            <!-- Options injected here -->
                        </div>

                        <!-- Action Bar -->
                        <div class="flex items-center justify-between pt-6 border-t border-white/10">
                            <button onclick="app.requestHint()" id="hint-btn" class="text-slate-400 hover:text-emerald-400 text-sm flex items-center space-x-2 transition-colors">
                                <i class="fas fa-lightbulb"></i>
                                <span>Request AI Hint</span>
                            </button>
                            <button onclick="app.submitAnswer()" id="submit-btn" class="px-6 py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2">
                                <span>Submit Answer</span>
                                <i class="fas fa-check"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Feedback Modal -->
                    <div id="feedback-modal" class="hidden absolute inset-0 bg-slate-900/95 backdrop-blur-md z-30 flex items-center justify-center p-8">
                        <div class="max-w-2xl w-full space-y-6">
                            <div class="flex items-center space-x-4 mb-6">
                                <div id="feedback-icon" class="w-16 h-16 rounded-full flex items-center justify-center text-3xl">
                                    <!-- Icon injected -->
                                </div>
                                <div>
                                    <h3 id="feedback-title" class="text-2xl font-bold"></h3>
                                    <p id="feedback-subtitle" class="text-slate-400"></p>
                                </div>
                            </div>

                            <div class="glass-card p-6 rounded-xl border-l-4" id="feedback-content-box">
                                <h4 class="font-semibold mb-3 flex items-center space-x-2">
                                    <i class="fas fa-graduation-cap text-emerald-400"></i>
                                    <span>AI Explanation</span>
                                </h4>
                                <p id="feedback-text" class="text-slate-300 leading-relaxed"></p>
                                
                                <div class="mt-4 p-4 rounded-lg bg-slate-800/50 border border-white/5">
                                    <p class="text-xs text-slate-400 uppercase tracking-wider mb-2">Related Farming Tips (Vector Search Results)</p>
                                    <ul id="related-tips" class="space-y-2 text-sm text-slate-300">
                                        <!-- Tips injected here -->
                                    </ul>
                                </div>
                            </div>

                            <div class="flex justify-end space-x-3">
                                <button onclick="app.showDetailedAnalysis()" class="px-4 py-2 text-slate-400 hover:text-white text-sm transition-colors">
                                    View Technical Details
                                </button>
                                <button onclick="app.nextQuestion()" class="px-6 py-3 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg font-medium transition-all flex items-center space-x-2">
                                    <span>Continue</span>
                                    <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- LLM Status Bar -->
                <div class="glass-card rounded-xl p-4 flex items-center justify-between text-sm">
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2">
                            <div class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></div>
                            <span class="text-slate-400">Model:</span>
                            <span class="text-emerald-400 font-mono">agri-mind-v2.1</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="text-slate-400">Latency:</span>
                            <span id="latency-display" class="text-emerald-400 font-mono">24ms</span>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2 text-slate-400">
                        <i class="fas fa-shield-alt text-emerald-500"></i>
                        <span>Factual Confidence: <span class="text-emerald-400">94%</span></span>
                    </div>
                </div>
            </div>

            <!-- Right Sidebar: Knowledge Base -->
            <div class="lg:col-span-3 space-y-6">
                <!-- Search -->
                <div class="glass-card rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4">Vector Search</h3>
                    <div class="relative">
                        <input type="text" id="kb-search" placeholder="Search farming tips..." 
                            class="w-full bg-slate-800/50 border border-white/10 rounded-lg px-4 py-3 text-sm focus:outline-none focus:border-emerald-500 transition-colors"
                            onkeyup="app.searchKnowledgeBase(this.value)">
                        <i class="fas fa-search absolute right-3 top-3.5 text-slate-400"></i>
                    </div>
                    <div id="search-results" class="mt-4 space-y-2 max-h-64 overflow-y-auto hidden">
                        <!-- Search results -->
                    </div>
                </div>

                <!-- Recent Tips -->
                <div class="glass-card rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4 flex items-center space-x-2">
                        <i class="fas fa-history text-emerald-400"></i>
                        <span>Recent Learnings</span>
                    </h3>
                    <div id="recent-tips" class="space-y-3">
                        <p class="text-sm text-slate-400 text-center py-4">No tips viewed yet</p>
                    </div>
                </div>

                <!-- Performance Chart -->
                <div class="glass-card rounded-2xl p-6">
                    <h3 class="text-lg font-semibold mb-4">Accuracy Trend</h3>
                    <canvas id="performance-chart" class="w-full h-40"></canvas>
                </div>
            </div>
        </div>

        <!-- Technical Details Modal -->
        <div id="tech-modal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
            <div class="glass-card rounded-2xl max-w-4xl w-full max-h-[80vh] overflow-hidden flex flex-col">
                <div class="p-6 border-b border-white/10 flex justify-between items-center">
                    <h3 class="text-xl font-bold flex items-center space-x-2">
                        <i class="fas fa-code text-emerald-400"></i>
                        <span>Technical Analysis</span>
                    </h3>
                    <button onclick="app.closeTechModal()" class="text-slate-400 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="p-6 overflow-y-auto space-y-6">
                    <!-- Vector DB Query -->
                    <div>
                        <h4 class="text-sm font-semibold text-emerald-400 mb-2 uppercase tracking-wider">Vector Database Query</h4>
                        <div class="code-block text-xs">
                            <pre id="tech-vector-query">SELECT tip_id, content, cosine_similarity(embedding, query_vec) 
FROM farming_tips 
WHERE category = 'crop_management'
ORDER BY similarity DESC
LIMIT 5;</pre>
                        </div>
                    </div>
                    
                    <!-- LLM Prompt -->
                    <div>
                        <h4 class="text-sm font-semibold text-amber-400 mb-2 uppercase tracking-wider">LLM Evaluation Prompt</h4>
                        <div class="code-block text-xs">
                            <pre id="tech-llm-prompt">System: You are an agricultural expert AI. Evaluate the user's answer...
User Answer: "Nitrogen fixation through root nodules"
Expected: "Legumes fix atmospheric nitrogen via Rhizobium bacteria..."
Evaluation: CORRECT - User demonstrates understanding of symbiotic nitrogen fixation.</pre>
                        </div>
                    </div>

                    <!-- Embedding Viz -->
                    <div>
                        <h4 class="text-sm font-semibold text-blue-400 mb-2 uppercase tracking-wider">Embedding Visualization (t-SNE)</h4>
                        <canvas id="embedding-viz" class="w-full h-64 rounded-lg bg-slate-900"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Python Backend -->
    <py-script>
import json
import random
import math
from typing import List, Dict, Any
from js import document, window, console, Chart
from pyodide.ffi import create_proxy

# Agricultural Knowledge Base (Simulated Vector DB)
FARMING_TIPS = [
    {
        "id": 1,
        "category": "Soil Science",
        "content": "Legumes fix atmospheric nitrogen through symbiotic relationship with Rhizobium bacteria in root nodules, reducing fertilizer needs.",
        "embedding": [0.9, 0.2, 0.1, 0.8, 0.3],  # Simulated 5D vector
        "difficulty": "medium"
    },
    {
        "id": 2,
        "category": "Irrigation",
        "content": "Drip irrigation reduces water usage by 30-50% compared to sprinkler systems by delivering water directly to root zones.",
        "embedding": [0.1, 0.9, 0.2, 0.3, 0.8],
        "difficulty": "easy"
    },
    {
        "id": 3,
        "category": "Pest Management",
        "content": "Integrated Pest Management (IPM) combines biological, cultural, and chemical methods to minimize pesticide use.",
        "embedding": [0.2, 0.1, 0.9, 0.4, 0.2],
        "difficulty": "hard"
    },
    {
        "id": 4,
        "category": "Crop Rotation",
        "content": "Rotating cereals with legumes breaks pest cycles and improves soil structure while maintaining nutrient balance.",
        "embedding": [0.8, 0.3, 0.4, 0.9, 0.1],
        "difficulty": "medium"
    },
    {
        "id": 5,
        "category": "Precision Agriculture",
        "content": "NDVI (Normalized Difference Vegetation Index) from drones identifies crop stress 2 weeks before visible symptoms.",
        "embedding": [0.3, 0.8, 0.1, 0.2, 0.9],
        "difficulty": "hard"
    },
    {
        "id": 6,
        "category": "Soil Science",
        "content": "Soil pH affects nutrient availability: phosphorus is most available between pH 6.0-7.0, while iron becomes deficient above pH 7.5.",
        "embedding": [0.9, 0.1, 0.3, 0.7, 0.2],
        "difficulty": "hard"
    },
    {
        "id": 7,
        "category": "Irrigation",
        "content": "Evapotranspiration (ET) rates determine irrigation scheduling; cool season crops require 20-30% less water than warm season crops.",
        "embedding": [0.2, 0.9, 0.1, 0.4, 0.7],
        "difficulty": "medium"
    },
    {
        "id": 8,
        "category": "Pest Management",
        "content": "Beneficial insects like ladybugs can consume 50 aphids per day, providing biological control worth $4.6 billion annually in the US.",
        "embedding": [0.1, 0.2, 0.9, 0.3, 0.1],
        "difficulty": "easy"
    }
]

# Question Bank with LLM Evaluation Logic
QUESTIONS = [
    {
        "id": 1,
        "category": "Soil Science",
        "question": "Which agricultural practice leverages symbiotic bacteria to reduce synthetic fertilizer requirements?",
        "options": [
            "Monocropping wheat varieties",
            "Planting legume cover crops",
            "Applying ammonium nitrate",
            "Deep tillage operations"
        ],
        "correct": 1,
        "explanation": "Legumes form symbiotic relationships with Rhizobium bacteria that fix atmospheric nitrogen into plant-available forms, eliminating the need for nitrogen fertilizers during the legume growth period.",
        "related_tips": [1, 4],
        "concepts": ["nitrogen fixation", "symbiosis", "legumes"]
    },
    {
        "id": 2,
        "category": "Irrigation",
        "question": "What is the primary advantage of drip irrigation over conventional sprinkler systems?",
        "options": [
            "Lower initial installation cost",
            "Reduced water consumption through targeted delivery",
            "Better frost protection",
            "Faster soil erosion prevention"
        ],
        "correct": 1,
        "explanation": "Drip irrigation delivers water directly to the root zone, minimizing evaporation and runoff. This precision reduces water usage by 30-50% compared to sprinklers that wet entire field surfaces.",
        "related_tips": [2, 7],
        "concepts": ["water efficiency", "precision irrigation", "evapotranspiration"]
    },
    {
        "id": 3,
        "category": "Pest Management",
        "question": "In Integrated Pest Management (IPM), what is the hierarchy of control methods?",
        "options": [
            "Chemical → Biological → Cultural",
            "Cultural → Biological → Chemical (last resort)",
            "Biological only, no exceptions",
            "Chemical rotation quarterly"
        ],
        "correct": 1,
        "explanation": "IPM prioritizes prevention through cultural practices (crop rotation, resistant varieties), followed by biological controls (beneficial insects), with chemical interventions used only when economic thresholds are exceeded.",
        "related_tips": [3, 8],
        "concepts": ["IPM", "economic threshold", "biological control"]
    },
    {
        "id": 4,
        "category": "Precision Agriculture",
        "question": "How does NDVI (Normalized Difference Vegetation Index) assist modern farmers?",
        "options": [
            "It predicts market prices",
            "It detects crop stress before visible symptoms",
            "It automates harvesting machinery",
            "It sterilizes seeds"
        ],
        "correct": 1,
        "explanation": "NDVI uses near-infrared and red light reflectance to measure plant chlorophyll content. This allows detection of water stress, nutrient deficiencies, or disease 10-14 days before symptoms become visible to the human eye.",
        "related_tips": [5],
        "concepts": ["remote sensing", "chlorophyll", "early detection"]
    },
    {
        "id": 5,
        "category": "Soil Science",
        "question": "At what pH range is phosphorus most available to plants, and why does this matter?",
        "options": [
            "pH 4.0-5.0 - acid loving plants",
            "pH 6.0-7.0 - optimal nutrient availability",
            "pH 8.0-9.0 - alkaline preference",
            "pH doesn't affect phosphorus"
        ],
        "correct": 1,
        "explanation": "Phosphorus availability peaks between pH 6.0-7.0. In acidic soils (pH < 6.0), phosphorus binds with aluminum and iron; in alkaline soils (pH > 7.0), it binds with calcium, both becoming plant-unavailable.",
        "related_tips": [6],
        "concepts": ["nutrient availability", "pH chemistry", "phosphorus fixation"]
    }
]

class VectorDatabase:
    """Simulated Vector Database with cosine similarity search"""
    
    @staticmethod
    def cosine_similarity(v1: List[float], v2: List[float]) -> float:
        dot = sum(a*b for a, b in zip(v1, v2))
        norm1 = math.sqrt(sum(a*a for a in v1))
        norm2 = math.sqrt(sum(b*b for b in v2))
        return dot / (norm1 * norm2) if norm1 and norm2 else 0
    
    @classmethod
    def search(cls, query_vector: List[float], category: str = None, top_k: int = 3) -> List[Dict]:
        results = []
        for tip in FARMING_TIPS:
            if category and tip["category"] != category:
                continue
            score = cls.cosine_similarity(query_vector, tip["embedding"])
            results.append({**tip, "score": score})
        
        results.sort(key=lambda x: x["score"], reverse=True)
        return results[:top_k]

class LLMEvaluator:
    """Simulated LLM for answer evaluation and explanation generation"""
    
    @staticmethod
    def evaluate_answer(question: Dict, selected_option: int, user_text: str = "") -> Dict:
        is_correct = selected_option == question["correct"]
        
        # Generate contextual explanation based on correctness
        if is_correct:
            explanation = f"Excellent! You've correctly identified that {question['options'][selected_option]} is the right answer. "
            explanation += f"This demonstrates understanding of {', '.join(question['concepts'])}. "
            explanation += f"Key insight: {question['explanation']}"
            confidence = 0.95
        else:
            explanation = f"Not quite. While {question['options'][selected_option]} might seem plausible, "
            explanation += f"the correct approach is {question['options'][question['correct']]}. "
            explanation += f"Here's why: {question['explanation']} "
            explanation += f"Review these concepts: {', '.join(question['concepts'])}."
            confidence = 0.88
        
        return {
            "is_correct": is_correct,
            "explanation": explanation,
            "confidence": confidence,
            "concepts_tested": question["concepts"],
            "knowledge_gaps": [] if is_correct else question["concepts"]
        }

class AgriMindBackend:
    def __init__(self):
        self.current_question_idx = 0
        self.score = 0
        self.answers = []
        self.streak = 0
        self.history = []
        
    def get_next_question(self) -> Dict:
        if self.current_question_idx < len(QUESTIONS):
            return QUESTIONS[self.current_question_idx]
        return None
    
    def process_answer(self, question_id: int, selected_option: int) -> Dict:
        question = next(q for q in QUESTIONS if q["id"] == question_id)
        
        # LLM Evaluation
        evaluation = LLMEvaluator.evaluate_answer(question, selected_option)
        
        # Vector DB Retrieval for related tips
        query_vec = [random.random() for _ in range(5)]  # Simulated query embedding
        related_tips = VectorDatabase.search(query_vec, category=question["category"], top_k=3)
        
        # Update stats
        if evaluation["is_correct"]:
            self.score += 1
            self.streak += 1
        else:
            self.streak = 0
        
        self.answers.append({
            "question_id": question_id,
            "correct": evaluation["is_correct"],
            "concepts": question["concepts"]
        })
        self.current_question_idx += 1
        
        return {
            "evaluation": evaluation,
            "related_tips": related_tips,
            "progress": {
                "current": self.current_question_idx,
                "total": len(QUESTIONS),
                "score": self.score,
                "streak": self.streak,
                "accuracy": (self.score / self.current_question_idx) * 100 if self.current_question_idx > 0 else 0
            }
        }
    
    def search_knowledge(self, query: str) -> List[Dict]:
        # Simulate semantic search
        query_vec = [random.random() for _ in range(5)]
        return VectorDatabase.search(query_vec, top_k=5)

# Initialize backend
backend = AgriMindBackend()

# Expose to JavaScript
def get_next_question():
    q = backend.get_next_question()
    return json.dumps(q) if q else json.dumps(None)

def process_answer(question_id, selected_option):
    result = backend.process_answer(int(question_id), int(selected_option))
    return json.dumps(result)

def search_kb(query):
    results = backend.search_knowledge(query)
    return json.dumps(results)

def get_stats():
    return json.dumps({
        "current": backend.current_question_idx,
        "total": len(QUESTIONS),
        "score": backend.score,
        "streak": backend.streak,
        "accuracy": (backend.score / backend.current_question_idx) * 100 if backend.current_question_idx > 0 else 0
    })

window.get_next_question = create_proxy(get_next_question)
window.process_answer = create_proxy(process_answer)
window.search_kb = create_proxy(search_kb)
window.get_stats = create_proxy(get_stats)
    </py-script>

    <script>
        // Frontend Application Logic
        class AgriMindApp {
            constructor() {
                this.currentQuestion = null;
                this.selectedOption = null;
                this.stats = {
                    answered: 0,
                    correct: 0,
                    streak: 0,
                    accuracy: 0
                };
                this.performanceData = [];
                this.initCharts();
                this.initTopicFilters();
            }

            initCharts() {
                // Performance Chart
                const ctx = document.getElementById('performance-chart').getContext('2d');
                this.performanceChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Accuracy %',
                            data: [],
                            borderColor: '#059669',
                            backgroundColor: 'rgba(5, 150, 105, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { beginAtZero: true, max: 100, grid: { color: 'rgba(255,255,255,0.1)' } },
                            x: { grid: { display: false } }
                        }
                    }
                });

                // Vector Visualization
                this.drawVectorViz();
            }

            drawVectorViz() {
                const canvas = document.getElementById('vector-viz');
                const ctx = canvas.getContext('2d');
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;

                // Draw nodes
                const nodes = [
                    {x: 50, y: 80, color: '#059669', label: 'Soil'},
                    {x: 150, y: 40, color: '#3b82f6', label: 'Water'},
                    {x: 200, y: 120, color: '#ef4444', label: 'Pest'},
                    {x: 100, y: 160, color: '#f59e0b', label: 'Crop'},
                    {x: 250, y: 80, color: '#8b5cf6', label: 'Tech'}
                ];

                // Draw connections
                ctx.strokeStyle = 'rgba(255,255,255,0.1)';
                ctx.lineWidth = 1;
                nodes.forEach((node, i) => {
                    nodes.forEach((other, j) => {
                        if (i < j) {
                            ctx.beginPath();
                            ctx.moveTo(node.x, node.y);
                            ctx.lineTo(other.x, other.y);
                            ctx.stroke();
                        }
                    });
                });

                // Draw nodes
                nodes.forEach(node => {
                    ctx.beginPath();
                    ctx.arc(node.x, node.y, 8, 0, Math.PI * 2);
                    ctx.fillStyle = node.color;
                    ctx.fill();
                    
                    ctx.fillStyle = 'rgba(255,255,255,0.6)';
                    ctx.font = '10px Inter';
                    ctx.fillText(node.label, node.x - 10, node.y + 20);
                });
            }

            initTopicFilters() {
                const topics = ['All Topics', 'Soil Science', 'Irrigation', 'Pest Management', 'Precision Agriculture', 'Crop Rotation'];
                const container = document.getElementById('topic-filters');
                
                topics.forEach((topic, idx) => {
                    const div = document.createElement('div');
                    div.className = `flex items-center justify-between p-3 rounded-lg cursor-pointer transition-all ${idx === 0 ? 'bg-emerald-500/20 border border-emerald-500/30' : 'hover:bg-white/5'}`;
                    div.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <div class="w-2 h-2 rounded-full ${idx === 0 ? 'bg-emerald-400' : 'bg-slate-600'}"></div>
                            <span class="text-sm ${idx === 0 ? 'text-emerald-400' : 'text-slate-300'}">${topic}</span>
                        </div>
                        <span class="text-xs text-slate-500">${idx === 0 ? '436' : Math.floor(Math.random() * 100 + 20)}</span>
                    `;
                    div.onclick = () => this.filterTopic(topic, div);
                    container.appendChild(div);
                });
            }

            filterTopic(topic, element) {
                // Visual feedback only for demo
                document.querySelectorAll('#topic-filters > div').forEach(el => {
                    el.className = 'flex items-center justify-between p-3 rounded-lg cursor-pointer transition-all hover:bg-white/5';
                    el.querySelector('div > div').className = 'w-2 h-2 rounded-full bg-slate-600';
                    el.querySelector('div > span').className = 'text-sm text-slate-300';
                });
                element.className = 'flex items-center justify-between p-3 rounded-lg cursor-pointer transition-all bg-emerald-500/20 border border-emerald-500/30';
                element.querySelector('div > div').className = 'w-2 h-2 rounded-full bg-emerald-400';
                element.querySelector('div > span').className = 'text-sm text-emerald-400';
            }

            async startQuiz() {
                document.getElementById('start-screen').classList.add('hidden');
                document.getElementById('question-interface').classList.remove('hidden');
                await this.loadQuestion();
            }

            async loadQuestion() {
                document.getElementById('loading-state').classList.remove('hidden');
                
                // Simulate network delay
                await new Promise(r => setTimeout(r, 800));
                
                const result = window.get_next_question();
                const question = JSON.parse(result);
                
                if (!question) {
                    this.showCompletion();
                    return;
                }

                this.currentQuestion = question;
                this.selectedOption = null;

                // Update UI
                document.getElementById('question-category').textContent = question.category;
                document.getElementById('q-current').textContent = this.stats.answered + 1;
                document.getElementById('q-total').textContent = '5';
                
                // Typewriter effect for question
                const qText = document.getElementById('question-text');
                qText.textContent = '';
                qText.classList.add('typing-cursor');
                
                let i = 0;
                const typeInterval = setInterval(() => {
                    if (i < question.question.length) {
                        qText.textContent += question.question.charAt(i);
                        i++;
                    } else {
                        clearInterval(typeInterval);
                        qText.classList.remove('typing-cursor');
                    }
                }, 30);

                // Render options
                const optionsContainer = document.getElementById('options-container');
                optionsContainer.innerHTML = '';
                
                question.options.forEach((option, idx) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-card w-full text-left p-4 rounded-xl bg-slate-800/50 border border-white/10 flex items-center space-x-4 group';
                    btn.innerHTML = `
                        <div class="w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center text-sm font-bold group-hover:bg-emerald-600 transition-colors">
                            ${String.fromCharCode(65 + idx)}
                        </div>
                        <span class="flex-1">${option}</span>
                        <i class="fas fa-check-circle text-emerald-400 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                    `;
                    btn.onclick = () => this.selectOption(idx, btn);
                    optionsContainer.appendChild(btn);
                });

                document.getElementById('loading-state').classList.add('hidden');
                document.getElementById('submit-btn').disabled = true;
            }

            selectOption(index, element) {
                this.selectedOption = index;
                
                // Update visual selection
                document.querySelectorAll('.option-card').forEach(el => {
                    el.classList.remove('selected');
                    el.querySelector('div').classList.remove('bg-emerald-600');
                    el.querySelector('div').classList.add('bg-slate-700');
                });
                
                element.classList.add('selected');
                element.querySelector('div').classList.remove('bg-slate-700');
                element.querySelector('div').classList.add('bg-emerald-600');
                
                document.getElementById('submit-btn').disabled = false;
            }

            async submitAnswer() {
                if (this.selectedOption === null) return;

                document.getElementById('submit-btn').innerHTML = '<div class="spinner mr-2"></div> Evaluating...';
                
                // Call Python backend
                const result = window.process_answer(this.currentQuestion.id, this.selectedOption);
                const data = JSON.parse(result);
                
                this.stats.answered++;
                if (data.evaluation.is_correct) {
                    this.stats.correct++;
                    this.stats.streak = data.progress.streak;
                } else {
                    this.stats.streak = 0;
                }
                this.stats.accuracy = Math.round((this.stats.correct / this.stats.answered) * 100);

                // Update performance chart
                this.performanceData.push(this.stats.accuracy);
                this.performanceChart.data.labels.push(`Q${this.stats.answered}`);
                this.performanceChart.data.datasets[0].data.push(this.stats.accuracy);
                this.performanceChart.update();

                // Show feedback
                this.showFeedback(data);
                
                // Update stats display
                this.updateStatsDisplay();
            }

            showFeedback(data) {
                const modal = document.getElementById('feedback-modal');
                const isCorrect = data.evaluation.is_correct;
                
                // Icon and colors
                const icon = document.getElementById('feedback-icon');
                const title = document.getElementById('feedback-title');
                const contentBox = document.getElementById('feedback-content-box');
                
                if (isCorrect) {
                    icon.className = 'w-16 h-16 rounded-full flex items-center justify-center text-3xl bg-emerald-500/20 text-emerald-400';
                    icon.innerHTML = '<i class="fas fa-check"></i>';
                    title.textContent = 'Correct!';
                    title.className = 'text-2xl font-bold text-emerald-400';
                    contentBox.className = 'glass-card p-6 rounded-xl border-l-4 border-emerald-500 bg-emerald-500/5';
                    this.triggerConfetti();
                } else {
                    icon.className = 'w-16 h-16 rounded-full flex items-center justify-center text-3xl bg-red-500/20 text-red-400';
                    icon.innerHTML = '<i class="fas fa-times"></i>';
                    title.textContent = 'Learning Opportunity';
                    title.className = 'text-2xl font-bold text-red-400';
                    contentBox.className = 'glass-card p-6 rounded-xl border-l-4 border-red-500 bg-red-500/5';
                }

                document.getElementById('feedback-subtitle').textContent = 
                    `${isCorrect ? 'Excellent understanding' : 'Review the concepts below'} • Confidence: ${Math.round(data.evaluation.confidence * 100)}%`;
                
                document.getElementById('feedback-text').textContent = data.evaluation.explanation;

                // Related tips
                const tipsList = document.getElementById('related-tips');
                tipsList.innerHTML = '';
                data.related_tips.forEach(tip => {
                    const li = document.createElement('li');
                    li.className = 'flex items-start space-x-2';
                    li.innerHTML = `
                        <i class="fas fa-quote-left text-emerald-500/50 mt-1"></i>
                        <span>${tip.content.substring(0, 100)}...</span>
                    `;
                    tipsList.appendChild(li);
                });

                modal.classList.remove('hidden');
                
                // Reset button
                document.getElementById('submit-btn').innerHTML = '<span>Submit Answer</span><i class="fas fa-check"></i>';
            }

            nextQuestion() {
                document.getElementById('feedback-modal').classList.add('hidden');
                this.loadQuestion();
            }

            updateStatsDisplay() {
                // Animate progress ring
                const circle = document.getElementById('progress-circle');
                const radius = 56;
                const circumference = 2 * Math.PI * radius;
                const offset = circumference - (this.stats.accuracy / 100) * circumference;
                circle.style.strokeDashoffset = offset;
                
                document.getElementById('progress-text').textContent = this.stats.accuracy + '%';
                document.getElementById('stats-answered').textContent = this.stats.answered;
                document.getElementById('stats-accuracy').textContent = this.stats.accuracy + '%';
                document.getElementById('stats-streak').textContent = this.stats.streak;
                document.getElementById('streak-display').textContent = this.stats.streak;
            }

            triggerConfetti() {
                for (let i = 0; i < 20; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * 100 + '%';
                        confetti.style.backgroundColor = ['#059669', '#10b981', '#f59e0b', '#3b82f6'][Math.floor(Math.random() * 4)];
                        confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                        document.getElementById('quiz-container').appendChild(confetti);
                        setTimeout(() => confetti.remove(), 4000);
                    }, i * 50);
                }
            }

            requestHint() {
                const btn = document.getElementById('hint-btn');
                btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> <span>Consulting LLM...</span>';
                
                setTimeout(() => {
                    const hints = [
                        "Think about the symbiotic relationships in agriculture...",
                        "Consider water efficiency metrics in modern farming...",
                        "Remember the hierarchy of IPM strategies...",
                        "Reflect on remote sensing technologies..."
                    ];
                    const hint = hints[Math.floor(Math.random() * hints.length)];
                    
                    const contextBox = document.getElementById('context-box');
                    document.getElementById('context-text').textContent = "💡 AI Hint: " + hint;
                    contextBox.classList.remove('hidden');
                    
                    btn.innerHTML = '<i class="fas fa-lightbulb text-emerald-400"></i> <span>Hint Provided</span>';
                    btn.disabled = true;
                }, 1000);
            }

            searchKnowledgeBase(query) {
                if (!query) {
                    document.getElementById('search-results').classList.add('hidden');
                    return;
                }

                const results = JSON.parse(window.search_kb(query));
                const container = document.getElementById('search-results');
                container.innerHTML = '';
                
                results.forEach(tip => {
                    const div = document.createElement('div');
                    div.className = 'p-3 rounded-lg bg-slate-800/50 border border-white/5 text-sm hover:bg-slate-700/50 cursor-pointer transition-colors';
                    div.innerHTML = `
                        <div class="flex items-center justify-between mb-1">
                            <span class="text-xs text-emerald-400 font-medium">${tip.category}</span>
                            <span class="text-xs text-slate-500">${Math.round(tip.score * 100)}% match</span>
                        </div>
                        <p class="text-slate-300 line-clamp-2">${tip.content}</p>
                    `;
                    div.onclick = () => this.addToRecentTips(tip);
                    container.appendChild(div);
                });
                
                container.classList.remove('hidden');
            }

            addToRecentTips(tip) {
                const container = document.getElementById('recent-tips');
                if (container.querySelector('p')) container.innerHTML = '';
                
                const div = document.createElement('div');
                div.className = 'glass-card p-3 rounded-lg border-l-2 border-emerald-500 text-sm animate-pulse';
                div.innerHTML = `
                    <p class="text-slate-300 text-xs mb-1">${tip.category}</p>
                    <p class="text-white line-clamp-2">${tip.content}</p>
                `;
                
                container.insertBefore(div, container.firstChild);
                if (container.children.length > 5) container.removeChild(container.lastChild);
                
                setTimeout(() => div.classList.remove('animate-pulse'), 1000);
            }

            showDetailedAnalysis() {
                document.getElementById('tech-modal').classList.remove('hidden');
                
                // Draw embedding visualization
                setTimeout(() => {
                    const canvas = document.getElementById('embedding-viz');
                    const ctx = canvas.getContext('2d');
                    canvas.width = canvas.offsetWidth;
                    canvas.height = canvas.offsetHeight;
                    
                    // Draw 3D scatter plot simulation
                    const points = [];
                    for (let i = 0; i < 50; i++) {
                        points.push({
                            x: Math.random() * canvas.width,
                            y: Math.random() * canvas.height,
                            z: Math.random(),
                            color: Math.random() > 0.5 ? '#059669' : '#3b82f6'
                        });
                    }
                    
                    points.forEach(p => {
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, 3 + p.z * 3, 0, Math.PI * 2);
                        ctx.fillStyle = p.color;
                        ctx.globalAlpha = 0.6;
                        ctx.fill();
                    });
                }, 100);
            }

            closeTechModal() {
                document.getElementById('tech-modal').classList.add('hidden');
            }

            showCompletion() {
                document.getElementById('question-interface').innerHTML = `
                    <div class="flex flex-col items-center justify-center h-full text-center space-y-6">
                        <div class="w-24 h-24 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center shadow-2xl mb-4">
                            <i class="fas fa-trophy text-4xl text-white"></i>
                        </div>
                        <h2 class="text-3xl font-bold brand-font">Assessment Complete!</h2>
                        <p class="text-slate-400">You've mastered ${this.stats.accuracy}% of the agricultural concepts covered.</p>
                        
                        <div class="grid grid-cols-3 gap-4 w-full max-w-md mt-6">
                            <div class="glass-card p-4 rounded-xl text-center">
                                <p class="text-2xl font-bold text-emerald-400">${this.stats.correct}</p>
                                <p class="text-xs text-slate-400">Correct</p>
                            </div>
                            <div class="glass-card p-4 rounded-xl text-center">
                                <p class="text-2xl font-bold text-amber-400">${this.stats.answered - this.stats.correct}</p>
                                <p class="text-xs text-slate-400">Review Needed</p>
                            </div>
                            <div class="glass-card p-4 rounded-xl text-center">
                                <p class="text-2xl font-bold text-blue-400">${this.stats.streak}</p>
                                <p class="text-xs text-slate-400">Best Streak</p>
                            </div>
                        </div>
                        
                        <button onclick="location.reload()" class="mt-8 px-8 py-4 bg-gradient-to-r from-emerald-600 to-teal-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-emerald-500/25 transition-all">
                            Restart Assessment
                        </button>
                    </div>
                `;
            }

            toggleProfile() {
                // Demo profile toggle
                alert('Profile settings would open here. Features:\n- Learning preferences\n- Difficulty settings\n- Knowledge gaps analysis\n- Export progress report');
            }
        }

        // Initialize app
        const app = new AgriMindApp();

        // Latency simulation
        setInterval(() => {
            const latency = Math.floor(Math.random() * 20 + 15);
            document.getElementById('latency-display').textContent = latency + 'ms';
        }, 3000);
    </script>
</body>
</html>
